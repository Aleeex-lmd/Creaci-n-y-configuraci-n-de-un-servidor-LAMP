Vagrant.configure("2") do |config|

    # Máquina Router
    config.vm.define :router do |router|
      router.vm.box = "debian/bookworm64"
      router.vm.hostname = "router"
    
      # Configuración de red privada 'red_intra'
      router.vm.network "private_network", ip: "11.0.0.1"
      router.vm.network :private_network,
                        :libvirt__network_name => "red_intra",
                        :type => "dhcp",
                        :libvirt__network_address => '192.168.200.0',
                        :libvirt__netmask => '255.255.255.0',
                        :libvirt__forward_mode => "nat"
      
      # Configuración de red pública
      router.vm.network :public_network,
                        bridge: "br0"
    
      # Deshabilitar la carpeta compartida
      router.vm.synced_folder ".", "/vagrant", disabled: true
    end
    
    # Máquina BD
    config.vm.define :bd do |bd|
      bd.vm.box = "debian/bookworm64"
      bd.vm.hostname = "bd"
      
      # Conectar a 'red_intra'
      bd.vm.network :private_network, 
                    :libvirt__network_name => "red_intra", 
                    :type => "dhcp"
  
      # Conectar a 'red_datos'
      bd.vm.network :private_network,
                    :libvirt__network_name => "red_datos",
                    :type => "dhcp"
    end
  
    # Máquina Web
    config.vm.define :web do |web|
      web.vm.box = "debian/bookworm64"
      web.vm.hostname = "web"
      
      # Conectar a 'red_intra'
      web.vm.network :private_network, 
                     :libvirt__network_name => "red_intra", 
                     :type => "dhcp"
  
      # Conectar a 'red_datos'
      web.vm.network :private_network,
                     :libvirt__network_name => "red_datos",
                     :type => "dhcp"
    end
  
    # Máquina SAN
    config.vm.define :san do |san|
      san.vm.box = "debian/bookworm64"
      san.vm.hostname = "san"
  
      # Conectar a 'red_intra'
      san.vm.network :private_network, 
                     :libvirt__network_name => "red_intra", 
                     :type => "dhcp"
  
      # Conectar a 'red_datos'
      san.vm.network :private_network,
                     :libvirt__network_name => "red_datos",
                     :type => "dhcp"
  
      # Añadir tres discos de 2G cada uno para el RAID5
      san.vm.provider :libvirt do |libvirt|
        libvirt.storage :file, size: "2G", path: "/var/lib/libvirt/images/san_disk1.qcow2"
        libvirt.storage :file, size: "2G", path: "/var/lib/libvirt/images/san_disk2.qcow2"
        libvirt.storage :file, size: "2G", path: "/var/lib/libvirt/images/san_disk3.qcow2"
      end
    end
  
  end
  